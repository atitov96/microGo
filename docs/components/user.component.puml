@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

Container_Boundary(user_service, "User Service") {
    Component(user_controller, "User Controller", "Go", "Handles user profile requests")
    Component(profile_manager, "Profile Manager", "Go", "Manages user profiles")
    Component(avatar_handler, "Avatar Handler", "Go", "Handles avatar uploads")
    Component(search_engine, "Search Engine", "Go", "Handles user search")
    ComponentDb(user_repo, "User Repository", "Go", "Manages user data in MongoDB")
}

System_Ext(db, "User Database", "MongoDB")
System_Ext(storage, "File Storage", "Stores user avatars")
System_Ext(event_bus, "Event Bus", "Kafka")

Rel(user_controller, profile_manager, "Uses")
Rel(user_controller, avatar_handler, "Uses")
Rel(user_controller, search_engine, "Uses")
Rel(profile_manager, user_repo, "Uses")
Rel(user_repo, db, "Reads from and writes to")
Rel(avatar_handler, storage, "Stores files in")
Rel(profile_manager, event_bus, "Publishes events to")

@enduml